- path: ${NODE_SCRIPTS_PATH}/init/registerTopology.sh
  permissions: "550"
  content: |
    #!/bin/bash

    if [[ $(cat ${NODE_HOME}/.config.json | jq '.relayIPs | length') -eq 0 ]]; then
      echo "Enter relay node IP address."
      read _RELAY_NODE_IP_1
      if [ ! -z $_RELAY_NODE_IP_1 ]; then
        . ${NODE_SCRIPTS_PATH}/updateConfigIP.sh "add" $_RELAY_NODE_IP_1
      fi
    fi

    for IP in $(cat ${NODE_HOME}/.config.json | jq -r '.relayIPs[]' ); do
    if [ ! -z "$IP" ]; then
      . ${NODE_SCRIPTS_PATH}/updateTopologyIP.sh "add" $IP
    fi
    done

    if [ -f /home/${NODE_USER}/.nodeSetup ]; then
      sed -i "s#\Register Pool Topology|Running#Register Pool Topology|Complete#g" /home/${NODE_USER}/.nodeSetup
    fi